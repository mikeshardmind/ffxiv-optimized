Keep rotation optimization seperate, the logic for it is a little different.
